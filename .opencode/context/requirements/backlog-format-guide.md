# Backlog Format Guide

> **Scope:** This guide defines the OUTPUT FORMAT ONLY for backlog artifacts.
> For INVEST principles and story quality standards, see `user-story-best-practices.md`
> For agent workflows and operational guidance, see agent definitions

This document defines the format and conventions for the project backlog, using a 2-level structure: a main index and separate files for each story.

**Templates:**
- Initialize index from `.opencode/templates/backlog.md`
- Initialize story files from `.opencode/templates/story-template.md`

## File Structure

```
docs/
â”œâ”€â”€ backlog.md                    # Main index with overview
â””â”€â”€ stories/
    â”œâ”€â”€ US-001-description.md     # Individual story files
    â”œâ”€â”€ US-002-description.md
    â””â”€â”€ ...
```

## Index Format: `docs/backlog.md`

### Template Structure

```markdown
# Product Backlog

## ðŸ“¦ EP-XXX: Epic Name

Brief description of epic and strategic objective.

**Stories:**
- [ ] [US-XXX](stories/US-XXX-slug.md) - Brief title | **PRIORITY** | Xpt
- [~] [US-YYY](stories/US-YYY-slug.md) - Brief title | **PRIORITY** | Xpt
- [x] [US-ZZZ](stories/US-ZZZ-slug.md) - Brief title | **PRIORITY** | Xpt âœ… YYYY-MM-DD

---

**Legend:**
- `[ ]` = TODO (storia creata, non ancora pianificata)
- `[P]` = PLANNED (task definiti, pronta per sviluppo)
- `[~]` = IN PROGRESS (sviluppo in corso)
- `[x]` = DONE (completata)
- `[!]` = BLOCKED (bloccata)
```

### Index Conventions

**Epic:**
- Format: `## ðŸ“¦ EP-XXX: Epic Name`
- Numeric ID with 3-digit zero-padding: EP-001, EP-002, ..., EP-999
- Descriptive and concise name

**Story in list:**
- Markdown checkbox for state: `[ ]`, `[~]`, `[x]`, `[!]`
- Relative link: `[US-XXX](stories/US-XXX-slug.md)`
- Brief title (max 60 characters)
- Inline metadata separated by `|`:
  - **Priority:** HIGH | MEDIUM | LOW
  - Estimate: story points (1-8)
- Optional completion date: `âœ… YYYY-MM-DD`

**Example:**
```markdown
- [~] [US-001](stories/US-001-book-data-entry.md) - Book data entry | **HIGH** | 3pt
```

## Story Format: `docs/stories/US-XXX-slug.md`

### Complete Template

```markdown
# US-XXX: User Story Title

**Epic:** EP-XXX | **Priority:** HIGH/MEDIUM/LOW | **Estimate:** Xpt | **Status:** TODO/IN PROGRESS/DONE/BLOCKED

## User Story

As [role/persona]
I want [functionality/action]
So that [benefit/value]

## Acceptance Criteria

- âœ“ [Criterion 1: happy path scenario]
- âœ“ [Criterion 2: error handling]
- âœ“ [Criterion 3: edge case]

## Tasks

- [ ] TK-001: Task description with technical details
- [~] TK-002: Task description with technical details (in progress)
- [x] TK-003: Task description with technical details âœ… YYYY-MM-DD

## Dev Notes

**YYYY-MM-DD** - Event/Task completed
- Implementation note
- Technical decision
- Issue encountered
```

### Story Conventions

**Header Metadata:**
- **Epic:** Parent epic ID (e.g., EP-001)
- **Priority:** HIGH | MEDIUM | LOW
- **Estimate:** Story points (1-8, Fibonacci scale)
- **Status:** TODO | PLANNED | IN PROGRESS | DONE | BLOCKED

**User Story:**
- Structure: As [role] I want [action] So that [value]

**Acceptance Criteria:**
- Minimum 3 scenarios:
  1. Happy path (normal case)
  2. Error handling/validation
  3. Edge case/boundary condition
- Format: bullet list with `âœ“` prefix
- Describe expected behavior, not implementation

**Tasks:**
- Generated by architect-agent via `/plan-story` command
- Executable technical tasks for developers to implement
- Format: markdown checkbox with TK-XXX ID
- Task naming: `TK-XXX: [Action verb] [Component/layer] [Technical details]`
- ID convention: TK-001, TK-002, ..., TK-999 (3-digit zero-padded, sequential within story)
- Technology-specific (mentions frameworks, libraries, tools)
- Ordered by dependencies (data â†’ logic â†’ API â†’ UI â†’ tests â†’ docs)
- States: `[ ]` TODO, `[~]` IN PROGRESS, `[x]` DONE
- Optional completion date: `âœ… YYYY-MM-DD`
- Example: `- [x] TK-005: Implement AuthService.register() with bcrypt hashing âœ… 2025-03-15`

**Dev Notes:**
- Optional section, populated during development
- Entry per date: `**YYYY-MM-DD** - Context`
- Content: technical decisions, issues, workarounds, test notes

**File Naming:**
- Pattern: `US-XXX-slug-description.md`
- XXX: 3-digit zero-padded number
- slug: keywords separated by dash (kebab-case)
- Example: `US-001-book-data-entry.md`

## States and Workflow

### Story States

**In backlog.md (checkbox):**
- `[ ]` **TODO** - Storia creata da analyst, task non ancora definiti
- `[P]` **PLANNED** - Storia ha task, pronta per sviluppo
- `[~]` **IN PROGRESS** - Sviluppo in corso
- `[x]` **DONE** - Completata, acceptance criteria verificati
- `[!]` **BLOCKED** - Bloccata da dipendenze o errori

**In story file (Status field):**
- **TODO** - Storia creata, in attesa di pianificazione task
- **PLANNED** - Task definiti, pronta per sviluppo
- **IN PROGRESS** - In sviluppo
- **DONE** - Completata
- **BLOCKED** - Bloccata

### Workflow Transitions

**Ciclo di vita storia:**
```
analyst-agent: Crea storia
    â†“
[ ] TODO (senza task)
    â†“
architect-agent: Genera task via /plan-story
    â†“
[P] PLANNED (task pronti, implementabile)
    â†“
developer-agent: Inizia implementazione via /dev-story
    â†“
[~] IN PROGRESS (sviluppa task)
    â†“
developer-agent: Completa tutti i task
    â†“
[x] DONE (completata, merged)

Qualsiasi stato â†’ [!] BLOCKED (se errori/dipendenze bloccano progresso)
```

**Transizioni di stato:**
- TODO â†’ PLANNED: architect-agent genera sezione Tasks via `/plan-story`
- PLANNED â†’ IN PROGRESS: developer-agent inizia primo task via `/dev-story`
- IN PROGRESS â†’ DONE: developer-agent completa ultimo task
- Qualsiasi â†’ BLOCKED: Errori o dipendenze impediscono progresso
- BLOCKED â†’ stato precedente: Issue risolto, ripresa lavoro

**Stati Task (all'interno della storia):**
```
[ ] TODO â†’ [~] IN PROGRESS â†’ [x] DONE
```

Tasks are created by architect-agent and implemented sequentially by developer-agent. Each task represents an atomic, testable piece of work.

## Complete Examples

See implementation plan for complete examples of:
- Index backlog.md with multiple epics
- Story file US-001 during development
- State transition workflow
- Git commit strategy
